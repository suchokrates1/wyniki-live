import{m as s}from"./main-Daz3_axt.js";window.Alpine=s;s.data("adminApp",()=>({activeTab:"courts",courts:[],newCourtId:"",newCourtOverlay:"",tournaments:[],selectedTournament:null,newTournament:{name:"",start_date:"",end_date:""},players:[],newPlayer:{name:"",category:"",country:""},importText:"",loading:{courts:!1,tournaments:!1,players:!1},toast:{show:!1,message:"",type:"info"},get filteredPlayers(){return this.players},init(){this.loadCourts(),this.loadTournaments()},showToast(t,e="info"){this.toast={show:!0,message:t,type:e},setTimeout(()=>{this.toast.show=!1},3e3)},async loadCourts(){this.loading.courts=!0;try{const t=await fetch("/admin/api/courts");if(!t.ok)throw new Error("Failed to load courts");this.courts=await t.json()}catch(t){console.error("Failed to load courts:",t),this.showToast("Błąd ładowania kortów","error")}finally{this.loading.courts=!1}},async refreshCourts(){await this.loadCourts(),this.showToast("Korty odświeżone","success")},async updateCourtOverlay(t,e){try{if(!(await fetch(`/admin/api/courts/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({overlay_id:e||null})})).ok)throw new Error("Failed to update court");this.showToast(`Kort ${t} zaktualizowany`,"success"),await this.loadCourts()}catch(o){console.error("Failed to update court:",o),this.showToast("Błąd aktualizacji kortu","error")}},async addCourt(){if(!this.newCourtId){this.showToast("Wprowadź ID kortu","warning");return}try{if(!(await fetch("/admin/api/courts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kort_id:this.newCourtId,overlay_id:this.newCourtOverlay||null})})).ok)throw new Error("Failed to add court");this.showToast(`Kort ${this.newCourtId} dodany`,"success"),this.newCourtId="",this.newCourtOverlay="",await this.loadCourts()}catch(t){console.error("Failed to add court:",t),this.showToast("Błąd dodawania kortu","error")}},async loadTournaments(){this.loading.tournaments=!0;try{const t=await fetch("/admin/api/tournaments");if(!t.ok)throw new Error("Failed to load tournaments");this.tournaments=await t.json()}catch(t){console.error("Failed to load tournaments:",t),this.showToast("Błąd ładowania turniejów","error")}finally{this.loading.tournaments=!1}},async createTournament(){if(!this.newTournament.name||!this.newTournament.start_date||!this.newTournament.end_date){this.showToast("Wypełnij wszystkie pola","warning");return}try{if(!(await fetch("/admin/api/tournaments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.newTournament)})).ok)throw new Error("Failed to create tournament");this.showToast("Turniej utworzony","success"),this.newTournament={name:"",start_date:"",end_date:""},await this.loadTournaments()}catch(t){console.error("Failed to create tournament:",t),this.showToast("Błąd tworzenia turnieju","error")}},async deleteTournament(t){if(confirm("Czy na pewno usunąć ten turniej?"))try{if(!(await fetch(`/admin/api/tournaments/${t}`,{method:"DELETE"})).ok)throw new Error("Failed to delete tournament");this.showToast("Turniej usunięty","success"),await this.loadTournaments()}catch(e){console.error("Failed to delete tournament:",e),this.showToast("Błąd usuwania turnieju","error")}},async activateTournament(t){try{if(!(await fetch(`/admin/api/tournaments/${t}/activate`,{method:"POST"})).ok)throw new Error("Failed to activate tournament");this.showToast("Turniej aktywowany","success"),await this.loadTournaments()}catch(e){console.error("Failed to activate tournament:",e),this.showToast("Błąd aktywacji turnieju","error")}},async selectTournament(t){this.selectedTournament=t,this.activeTab="players",await this.loadPlayers(t)},async loadPlayers(t){if(t){this.loading.players=!0;try{const e=await fetch(`/admin/api/tournaments/${t}/players`);if(!e.ok)throw new Error("Failed to load players");this.players=await e.json()}catch(e){console.error("Failed to load players:",e),this.showToast("Błąd ładowania graczy","error")}finally{this.loading.players=!1}}},async addPlayer(){if(!this.selectedTournament||!this.newPlayer.name){this.showToast("Wprowadź imię i nazwisko gracza","warning");return}try{if(!(await fetch(`/admin/api/tournaments/${this.selectedTournament}/players`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.newPlayer)})).ok)throw new Error("Failed to add player");this.showToast("Gracz dodany","success"),this.newPlayer={name:"",category:"",country:""},await this.loadPlayers(this.selectedTournament)}catch(t){console.error("Failed to add player:",t),this.showToast("Błąd dodawania gracza","error")}},async deletePlayer(t){if(confirm("Czy na pewno usunąć tego gracza?"))try{if(!(await fetch(`/admin/api/tournaments/${this.selectedTournament}/players/${t}`,{method:"DELETE"})).ok)throw new Error("Failed to delete player");this.showToast("Gracz usunięty","success"),await this.loadPlayers(this.selectedTournament)}catch(e){console.error("Failed to delete player:",e),this.showToast("Błąd usuwania gracza","error")}},async importPlayers(){if(!this.selectedTournament||!this.importText.trim()){this.showToast("Wprowadź dane graczy","warning");return}try{const e=this.importText.trim().split(`
`).filter(r=>r.trim()).map(r=>{const a=r.trim().split(/\s+/),n=a.slice(0,-2).join(" ")||a.join(" "),i=a[a.length-2]||"",l=a[a.length-1]||"";return{name:n,category:i,country:l}});if(!(await fetch(`/admin/api/tournaments/${this.selectedTournament}/players/bulk`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({players:e})})).ok)throw new Error("Failed to import players");this.showToast(`Zaimportowano ${e.length} graczy`,"success"),this.importText="",await this.loadPlayers(this.selectedTournament)}catch(t){console.error("Failed to import players:",t),this.showToast("Błąd importu graczy","error")}}}));s.start();
